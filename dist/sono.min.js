!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Sono=t()}}(function(){var t;return function e(t,n,i){function o(r,u){if(!n[r]){if(!t[r]){var a="function"==typeof require&&require;if(!u&&a)return a(r,!0);if(s)return s(r,!0);throw new Error("Cannot find module '"+r+"'")}var d=n[r]={exports:{}};t[r][0].call(d.exports,function(e){var n=t[r][1][e];return o(n?n:e)},d,d.exports,e,t,n,i)}return n[r].exports}for(var s="function"==typeof require&&require,r=0;r<i.length;r++)o(i[r]);return o}({1:[function(e,n){!function(e){function i(t,e,n,i,o){this._listener=e,this._isOnce=n,this.context=i,this._signal=t,this._priority=o||0}function o(t,e){if("function"!=typeof t)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",e))}function s(){this._bindings=[],this._prevParams=null;var t=this;this.dispatch=function(){s.prototype.dispatch.apply(t,arguments)}}i.prototype={active:!0,params:null,execute:function(t){var e,n;return this.active&&this._listener&&(n=this.params?this.params.concat(t):t,e=this._listener.apply(this.context,n),this._isOnce&&this.detach()),e},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},s.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(t,e,n,o){var s,r=this._indexOfListener(t,n);if(-1!==r){if(s=this._bindings[r],s.isOnce()!==e)throw new Error("You cannot add"+(e?"":"Once")+"() then add"+(e?"Once":"")+"() the same listener without removing the relationship first.")}else s=new i(this,t,e,n,o),this._addBinding(s);return this.memorize&&this._prevParams&&s.execute(this._prevParams),s},_addBinding:function(t){var e=this._bindings.length;do--e;while(this._bindings[e]&&t._priority<=this._bindings[e]._priority);this._bindings.splice(e+1,0,t)},_indexOfListener:function(t,e){for(var n,i=this._bindings.length;i--;)if(n=this._bindings[i],n._listener===t&&n.context===e)return i;return-1},has:function(t,e){return-1!==this._indexOfListener(t,e)},add:function(t,e,n){return o(t,"add"),this._registerListener(t,!1,e,n)},addOnce:function(t,e,n){return o(t,"addOnce"),this._registerListener(t,!0,e,n)},remove:function(t,e){o(t,"remove");var n=this._indexOfListener(t,e);return-1!==n&&(this._bindings[n]._destroy(),this._bindings.splice(n,1)),t},removeAll:function(){for(var t=this._bindings.length;t--;)this._bindings[t]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var t,e=Array.prototype.slice.call(arguments),n=this._bindings.length;if(this.memorize&&(this._prevParams=e),n){t=this._bindings.slice(),this._shouldPropagate=!0;do n--;while(t[n]&&this._shouldPropagate&&t[n].execute(e)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var r=s;r.Signal=s,"function"==typeof t&&t.amd?t(function(){return r}):"undefined"!=typeof n&&n.exports?n.exports=r:e.signals=r}(this)},{}],2:[function(t,e){"use strict";function n(){this.onChildComplete=new o.Signal,this.onComplete=new o.Signal,this.onProgress=new o.Signal,this.onError=new o.Signal,this.queue=[],this.index=0,this.loaders={},this.loaded=!1,this.webAudioContext=null,this.crossOrigin=!1,this.touchLocked=!1,this.numTotal=0,this.numLoaded=0}function i(){var t,e,n,i=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"];if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof window.ActiveXObject)for(e=0;3>e;e+=1){n=i[e];try{t=new window.ActiveXObject(n)}catch(o){}}return t}var o=t("signals");n.prototype={add:function(t,e){var i=new n.Loader(t,e);return i.webAudioContext=this.webAudioContext,i.crossOrigin=this.crossOrigin,i.touchLocked=this.touchLocked,this.queue.push(i),this.loaders[i.url]=i,this.numTotal++,i},start:function(){this.numTotal=this.queue.length,this.next()},next:function(){if(0===this.queue.length)return this.loaded=!0,void this.onComplete.dispatch(this.loaders);var t=this.queue.pop(),e=this;t.onComplete.addOnce(function(){e.numLoaded++,e.onProgress.getNumListeners()>0&&e.onProgress.dispatch(e.numLoaded/e.numTotal),e.onChildComplete.dispatch(t),e.next()}),t.onError.addOnce(function(){e.onError.dispatch(t),e.next()}),t.start()},addMultiple:function(t){for(var e=0;e<t.length;e++)this.add(t[e])},get:function(t){return this.loaders[t]}},n.Loader=function(t,e){this.url=t,this.type=e||this.url.split("?")[0].toLowerCase().split(".").pop(),this.onProgress=new o.Signal,this.onComplete=new o.Signal,this.onError=new o.Signal,this.webAudioContext=null,this.crossOrigin=!1,this.touchLocked=!1},n.Loader.prototype={start:function(){switch(this.type){case"mp3":case"ogg":this.loadAudio(this.webAudioContext,this.touchLocked);break;case"jpg":case"png":case"gif":this.loadImage(this.crossOrigin);break;case"json":this.loadJSON();break;default:throw"ERROR: Unknown type for file with URL: "+this.url}},loadAudio:function(t,e){t?this.loadWebAudio(t):this.loadHTML5Audio(e)},loadWebAudio:function(t){var e=new XMLHttpRequest;e.open("GET",this.url,!0),e.responseType="arraybuffer";var n=this;e.onprogress=function(t){if(t.lengthComputable){var e=t.loaded/t.total;n.onProgress.dispatch(e)}},e.onload=function(){t.decodeAudioData(e.response,function(t){n.data=t,n.onProgress.dispatch(1),n.onComplete.dispatch(t)},function(){n.onError.dispatch()})},e.onerror=function(t){n.onError.dispatch(t)},e.send(),this.request=e},loadHTML5Audio:function(t){var e=new Audio;this.data=e,e.name=this.url,e.preload="auto";var n=this;if(e.src=this.url,t)this.onProgress.dispatch(1),this.onComplete.dispatch(this.data);else{var i=function(){e.removeEventListener("canplaythrough",i),clearTimeout(o),n.onProgress.dispatch(1),n.onComplete.dispatch(n.data)},o=setTimeout(i,2e3);e.addEventListener("canplaythrough",i,!1),e.onerror=function(){clearTimeout(o),n.onError.dispatch()},e.load()}},loadImage:function(t){var e=new Image;this.data=e,e.name=this.url;var n=this;e.onload=function(){n.onComplete.dispatch(n.data)},e.onerror=function(){n.onError.dispatch()},t&&(e.crossOrigin="anonymous"),e.src=this.url},loadJSON:function(){function t(){return n.status>=400?void o.onError.dispatch():(o.json=o.data=JSON.parse(n.responseText),void o.onComplete.dispatch(o.data))}function e(){o.onError.dispatch()}var n=i();n.open("GET",this.url,!0),n.responseType="text";var o=this;"onload"in n&&"onerror"in n?(n.onload=t,n.onerror=e):n.onreadystatechange=function(){try{if(void 0!==this.done)return;this.status>=200&&this.status<300&&(this.done=!0,t()),this.status>=400&&(this.done=!0,e())}catch(n){}},n.send(),this.request=n},cancel:function(){this.request&&4!==this.request.readyState&&this.request.abort()}},e.exports=n},{signals:1}],3:[function(t,e){"use strict";function n(t,e){this.name="",this._loop=!1,this._volume=void 0===e?1:e,this._playing=!1,this._paused=!1,this._onEnded=null,this._endedListener=this.onEnded.bind(this),this._playWhenReady=!1,this.add(t)}n.prototype.add=function(t){this._el=t,this._playWhenReady&&this.play()},n.prototype.play=function(t,e){return this._el?(this.volume=this._volume,void 0!==e&&e>0&&(this._el.currentTime=e),void 0!==t&&t>0?this._delayTimeout=setTimeout(this.play.bind(this),t):this._el.play(),this._playing=!0,this._paused=!1,this._el.removeEventListener("ended",this._endedListener),void this._el.addEventListener("ended",this._endedListener,!1)):(this._playWhenReady=!0,this)},n.prototype.pause=function(){clearTimeout(this._delayTimeout),this._el&&(this._el.pause(),this._playing=!1,this._paused=!0)},n.prototype.stop=function(){if(this._el){this._el.pause();try{this._el.currentTime=0,this._el.currentTime>0&&this._el.load()}catch(t){}this._playing=!1,this._paused=!1}},n.prototype.onEnded=function(){this._playing=!1,this._paused=!1,this._loop?(this._el.currentTime=0,this._el.currentTime>0&&this._el.load(),this.play()):"function"==typeof this._onEnded&&this._onEnded()},n.prototype.addEndedListener=function(t,e){this._onEnded=t.bind(e||this)},n.prototype.removeEndedListener=function(){this._onEnded=null},Object.defineProperty(n.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t}}),Object.defineProperty(n.prototype,"volume",{get:function(){return this._volume},set:function(t){isNaN(t)||(this._volume=t,this._el&&void 0!==this._el.volume&&(this._el.volume=this._volume))}}),Object.defineProperty(n.prototype,"playing",{get:function(){return this._playing}}),Object.defineProperty(n.prototype,"paused",{get:function(){return this._paused}}),Object.defineProperty(n.prototype,"duration",{get:function(){return this._el?this._el.duration:0}}),Object.defineProperty(n.prototype,"currentTime",{get:function(){return this._el?this._el.currentTime:0}}),Object.defineProperty(n.prototype,"progress",{get:function(){return this.currentTime/this.duration}}),"object"==typeof e&&e.exports&&(e.exports=n)},{}],4:[function(t,e){"use strict";function n(){document[i]?r.dispatch():u.dispatch()}var i,o,s=t("signals"),r=new s.Signal,u=new s.Signal;"undefined"!=typeof document.hidden?(i="hidden",o="visibilitychange"):"undefined"!=typeof document.mozHidden?(i="mozHidden",o="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(i="msHidden",o="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(i="webkitHidden",o="webkitvisibilitychange"),void 0!==o&&document.addEventListener(o,n,!1),e.exports={onPageShown:u,onPageHidden:r}},{signals:1}],5:[function(t,e){"use strict";function n(t){function e(e,n){var i=t.createBiquadFilter();return i.type=e,void 0!==n&&(i.frequency.value=n),i}var n={gain:function(e){var n=t.createGain();return void 0!==e&&(n.gain.value=e),n},pan:function(){var e=t.createPanner();return e.panningModel="HRTF",e.distanceModel="linear",e.refDistance=1,e.maxDistance=1e3,e.rolloffFactor=1,e},filter:{lowpass:function(t){return e("lowpass",t)},highpass:function(t){return e("highpass",t)},bandpass:function(t){return e("bandpass",t)},lowshelf:function(t){return e("lowshelf",t)},highshelf:function(t){return e("highshelf",t)},peaking:function(t){return e("peaking",t)},notch:function(t){return e("notch",t)},allpass:function(t){return e("allpass",t)}},delay:function(e,n,i){var o=t.createDelay(),s=this.gain(i||.5);return void 0!==n&&(o.delayTime.value=n),o.connect(s),e.connect(o),s.connect(e),o},convolver:function(e){var n=t.createConvolver();return n.buffer=e,n},reverb:function(t,e,n){return this.convolver(this.createImpulseResponse(t,e,n))},createImpulseResponse:function(e,n,i){e=e||1,n=n||5,i=!!i;for(var o,s=2,r=t.sampleRate,u=r*e,a=t.createBuffer(s,u,r),d=a.getChannelData(0),h=a.getChannelData(1),c=0;u>c;c++)o=i?u-1:c,d[c]=(2*Math.random()-1)*Math.pow(1-o/u,n),h[c]=(2*Math.random()-1)*Math.pow(1-o/u,n);return a},analyser:function(e){e=e||1024;var n=t.createAnalyser();return n.smoothingTimeConstant=.85,n.fftSize=e,n},compressor:function(){var e=t.createDynamicsCompressor();return e.threshold.value=-24,e.knee.value=30,e.ratio.value=12,e.attack.value=3e-4,e.release.value=.25,e},distortion:function(){var e=t.createWaveShaper();return e},scriptProcessor:function(e,n,i,o,s){e=e||1024,n=void 0===n?0:n,i=void 0===i?1:i;var r=t.createScriptProcessor(e,n,i);return r.onaudioprocess=function(t){o.call(s||this,t)},r},microphoneSource:function(e,n){var i=t.createMediaStreamSource(e);return n&&i.connect(n),navigator.mozGetUserMedia&&(window.mozHack=i),i}},i={gain:function(){return{gain:{value:0}}},pan:function(){var t=function(){};return{panningModel:0,setPosition:t,setOrientation:t,setVelocity:t,distanceModel:0,refDistance:0,maxDistance:0,rolloffFactor:0,coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0}},filter:{lowpass:function(){return{type:0,frequency:{value:0}}},highpass:function(){return{type:0,frequency:{value:0}}},bandpass:function(){return{type:0,frequency:{value:0}}},lowshelf:function(){return{type:0,frequency:{value:0}}},highshelf:function(){return{type:0,frequency:{value:0}}},peaking:function(){return{type:0,frequency:{value:0}}},notch:function(){return{type:0,frequency:{value:0}}},allpass:function(){return{type:0,frequency:{value:0}}}},delay:function(){return{delayTime:{value:0}}},convolver:function(){return{buffer:0}},reverb:function(){return this.convolver()},createImpulseResponse:function(){return[]},analyser:function(){return{smoothingTimeConstant:0,fftSize:0,minDecibels:0,maxDecibels:0}},compressor:function(){return{threshold:{value:0},knee:{value:0},ratio:{value:0},attack:{value:0},release:{value:0}}},distortion:function(){return{oversample:0,curve:0}},scriptProcessor:function(){return{}},microphoneSource:function(){return{}}};return t?n:i}"object"==typeof e&&e.exports&&(e.exports=n)},{}],6:[function(t,e){"use strict";function n(t,e,n){this.name="",this._context=t,this._source=null,this._nodeList=[],this._gain=this._context.createGain(),this._gain.connect(n||this._context.destination),this._loop=!1,this._startedAt=0,this._pausedAt=0,this._playWhenReady=!1,this._onEnded=null,this.add(e)}var i=t("./webaudio-sound.js"),o=t("./html-sound.js");n.prototype.add=function(t){t&&(this._buffer=t,this._buffer.tagName?(this._sound=new o(t),this.getSource()):(this._sound=new i(t,this._context),this.getSource()),this._sound.addEndedListener(this.onEnded,this),this._playWhenReady&&this.play())},n.prototype.play=function(t,e){return this._sound?(this.getSource(),this._sound.loop=this._loop,void this._sound.play(t,e)):(this._playWhenReady=!0,this)},n.prototype.pause=function(){this._sound&&this._sound.pause()},n.prototype.stop=function(){this._sound&&this._sound.stop()},n.prototype.addNode=function(t){return this._nodeList.push(t),this.updateConnections(),t},n.prototype.removeNode=function(t){for(var e=this._nodeList.length,n=0;e>n;n++)t===this._nodeList[n]&&this._nodeList.splice(n,1);t.disconnect(0),this.updateConnections()},n.prototype.updateConnections=function(){if(this._source){for(var t=this._nodeList.length,e=0;t>e;e++)0===e?this._source.connect(this._nodeList[e]):this._nodeList[e-1].connect(this._nodeList[e]);this.destination?this.connectTo(this.destination):this._gain&&this.connectTo(this._gain)}},n.prototype.connectTo=function(t){var e=this._nodeList.length;e>0?this._nodeList[e-1].connect(t):this._source.connect(t),this.destination=t},n.prototype.onEnded=function(){"function"==typeof this._onEnded&&this._onEnded()},n.prototype.addEndedListener=function(t,e){this._onEnded=t.bind(e||this)},n.prototype.removeEndedListener=function(){this._onEnded=null},n.prototype.getSource=function(){return this._buffer.tagName?this._source||(this._source=this._context.createMediaElementSource(this._buffer),this.updateConnections()):(this._source=this._sound.source,this.updateConnections()),this._source},Object.defineProperty(n.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=!!t,this._sound&&(this._sound.loop=this._loop)}}),Object.defineProperty(n.prototype,"duration",{get:function(){return this._sound?this._sound.duration:0}}),Object.defineProperty(n.prototype,"currentTime",{get:function(){return this._sound?this._sound.currentTime:0}}),Object.defineProperty(n.prototype,"progress",{get:function(){return this._sound?this._sound.progress:0}}),Object.defineProperty(n.prototype,"volume",{get:function(){return this._gain.gain.value},set:function(t){isNaN(t)||(this._gain.gain.value=t)}}),Object.defineProperty(n.prototype,"playing",{get:function(){return this._sound?this._sound.playing:!1}}),Object.defineProperty(n.prototype,"paused",{get:function(){return this._sound?this._sound.paused:!1}}),"object"==typeof e&&e.exports&&(e.exports=n)},{"./html-sound.js":3,"./webaudio-sound.js":7}],7:[function(t,e){"use strict";function n(t,e){this.name="",this._buffer=t,this._context=e,this._source=null,this._loop=!1,this._startedAt=0,this._pausedAt=0,this._onEnded=null,this._playing=!1,this._paused=!1}n.prototype.add=function(t){return this._buffer=t,this._buffer},n.prototype.play=function(t,e){void 0===t&&(t=0),t>0&&(t=this._context.currentTime+t),void 0===e&&(e=0),this._pausedAt>0&&(e+=this._pausedAt/1e3),this.source.loop=this._loop,this.source.start(t,e),this._startedAt=Date.now()-this._pausedAt,this._pausedAt=0,this._playing=!0,this._paused=!1},n.prototype.pause=function(){var t=Date.now()-this._startedAt;this.stop(),this._pausedAt=t,this._playing=!1,this._paused=!0},n.prototype.stop=function(){this._source&&(this._source.onended=null,this._source.stop(0),this._source=null),this._startedAt=0,this._pausedAt=0,this._playing=!1,this._paused=!1},n.prototype.onEnded=function(){this.stop(),"function"==typeof this._onEnded&&this._onEnded()},n.prototype.addEndedListener=function(t,e){this._onEnded=t.bind(e||this)},n.prototype.removeEndedListener=function(){this._onEnded=null},Object.defineProperty(n.prototype,"source",{get:function(){return this._source||(this._source=this._context.createBufferSource(),this._source.buffer=this._buffer,this._source.onended=this.onEnded.bind(this)),this._source}}),Object.defineProperty(n.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=!!t}}),Object.defineProperty(n.prototype,"duration",{get:function(){return this._buffer?this._buffer.duration:0}}),Object.defineProperty(n.prototype,"currentTime",{get:function(){return this._pausedAt?.001*this._pausedAt:this._startedAt?.001*(Date.now()-this._startedAt):0}}),Object.defineProperty(n.prototype,"progress",{get:function(){return Math.min(this.currentTime/this.duration,1)}}),Object.defineProperty(n.prototype,"playing",{get:function(){return this._playing}}),Object.defineProperty(n.prototype,"paused",{get:function(){return this._paused}}),"object"==typeof e&&e.exports&&(e.exports=n)},{}],8:[function(t,e){"use strict";function n(t){function e(t){return isNaN(t)?0:parseFloat(t,10)}return{fade:function(e,n,i){e.gain.linearRampToValueAtTime(n,t.currentTime+i)},panHandler:function(n){return{x:function(t){var e=parseFloat(t,10)*Math.PI/4,i=e+Math.PI/2;i>Math.PI/2&&(i=Math.PI-i),e=Math.sin(e),i=Math.sin(i),n.setPosition(e,0,i)},xyz:function(t,i,o){t=e(t),i=e(i),o=e(o),n.setPosition(t,i,o)},setSourcePosition:function(t){n.setPosition(t.x,t.y,t.z)},setSourceOrientation:function(t){var e=t.clone().normalize(),i={x:0,y:1,z:0},o=t.clone().cross(i).cross(t).normalize();n.setOrientation(e.x,e.y,e.z,o.x,o.y,o.z)},setListenerPosition:function(e){t.listener.setPosition(e.x,e.y,e.z)},setListenerOrientation:function(e){var n=e.clone().normalize(),i={x:0,y:1,z:0},o=e.clone().cross(i).cross(e).normalize();t.listener.setOrientation(n.x,n.y,n.z,o.x,o.y,o.z)},doppler:function(t,e,i,o,s,r,u){n.setPosition(t,e,i),n.setVelocity(o/u,s/u,r/u)}}},filter:function(t,e,n,i){e=parseFloat(e,10),n=parseFloat(n,10),i=parseFloat(i,10),t.frequency.value=this.getFrequency(e)},getFrequency:function(e){var n=40,i=t.sampleRate/2,o=Math.log(i/n)/Math.LN2,s=Math.pow(2,o*(e-1));return i*s},distort:function(t){for(var e=100*t,n=22050,i=new Float32Array(n),o=Math.PI/180,s=0;n>s;s++){var r=2*s/n-1;i[s]=(3+e)*r*20*o/(Math.PI+e*Math.abs(r))}return i}}}"object"==typeof e&&e.exports&&(e.exports=n)},{}],9:[function(t,e){"use strict";function n(){this.VERSION="0.0.0",this._sounds={},this.context=this.createAudioContext(),this.hasWebAudio?(this._masterGain=this.context.createGain(),this._masterGain.connect(this.context.destination)):this._masterGain=1,this.getSupportedExtensions(),this.handleTouchlock(),this.handlePageVisibility(),this.initLoader(),this.log(!1)}var i=t("./lib/asset-loader.js"),o=t("./lib/html-sound.js"),s=t("./lib/page-visibility.js"),r=t("./lib/webaudio-nodefactory.js"),u=t("./lib/webaudio-player.js"),a=t("./lib/webaudio-utils.js");n.prototype.add=function(t,e,n){if(this._sounds[t])return this._sounds[t];var i;return i=this.hasWebAudio?new u(this.context,e,this._masterGain):new o(e,this._masterGain),i.name=t,i.loop=!!n,i.add(e),this._sounds[t]=i,i},n.prototype.get=function(t){return this._sounds[t]},n.prototype.mute=function(){this._preMuteVolume=this.volume,this.volume=0},n.prototype.unMute=function(){this.volume=this._preMuteVolume||1},n.prototype.pauseAll=function(){for(var t in this._sounds)this._sounds[t].playing&&this._sounds[t].pause()},n.prototype.resumeAll=function(){for(var t in this._sounds)this._sounds[t].paused&&this._sounds[t].play()},n.prototype.stopAll=function(){for(var t in this._sounds)this._sounds[t].stop()},n.prototype.play=function(t){this._sounds[t].play()},n.prototype.pause=function(t){this._sounds[t].pause()},n.prototype.stop=function(t){this._sounds[t].stop()},n.prototype.initLoader=function(){this._loader=new i,this._loader.touchLocked=this._isTouchLocked,this._loader.webAudioContext=this.context,this._loader.crossOrigin=!0},n.prototype.load=function(t,e,n,i,o,s){if(this._sounds[t])return this._sounds[t];var r=this.add(t,null,n);return e=this.getSupportedFile(e),r.loader=this._loader.add(e),r.loader.webAudioContext=s?this.context:null,r.loader.onComplete.add(function(t){r.add(t),i&&i.call(o||this,r)},this),r.loader.start(),r},n.prototype.loadBuffer=function(t,e,n,i,o){return this.load(t,e,n,i,o,!0)},n.prototype.loadAudioTag=function(t,e,n,i,o){return this.load(t,e,n,i,o,!1)},n.prototype.destroy=function(t){var e=this._sounds[t];delete this._sounds[t],e&&(e.loader&&e.loader.cancel(),e.stop())},n.prototype.createAudioContext=function(){var t=null;return window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext&&(t=new window.AudioContext),t},n.prototype.getSupportedFile=function(t){var e=this.getSupportedExtensions();if(t instanceof Array)for(var n=0;n<t.length;n++){var i=this.getExtension(t[n]),o=e.indexOf(i);if(o>-1)return t[n]}else if(t instanceof Object)for(var s in t){var r=this.getExtension(t[s]),u=e.indexOf(r);if(u>-1)return t[s]}else if("string"==typeof t&&!this.getExtension(t))return t.lastIndexOf(".")!==t.length-1&&(t+="."),t+e[0];return t},n.prototype.getExtension=function(t){t=t.split("?")[0];var e=t.split(".").pop();return e===t&&(e=""),e.toLowerCase()},n.prototype.getSupportedExtensions=function(){if(this._supportedExtensions)return this._supportedExtensions;var t=document.createElement("audio");if(!t)return[];for(var e=[{ext:"ogg",type:'audio/ogg; codecs="vorbis"'},{ext:"mp3",type:"audio/mpeg;"},{ext:"opus",type:'audio/ogg; codecs="opus"'},{ext:"wav",type:'audio/wav; codecs="1"'},{ext:"m4a",type:"audio/x-m4a;"},{ext:"m4a",type:"audio/aac;"}],n=[],i=0;i<e.length;i++){var o=e[i];t.canPlayType(o.type)&&n.push(o.ext)}return this._supportedExtensions=n,this._supportedExtensions},n.prototype.handleTouchlock=function(){var t=navigator.userAgent,e=!!t.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i),n=this,i=function(){if(document.body.removeEventListener("touchstart",i),n._isTouchLocked=!1,this._loader.touchLocked=!1,n.context){var t=n.context.createBuffer(1,1,22050),e=n.context.createBufferSource();e.buffer=t,e.connect(n.context.destination),e.start(0)}};e&&document.body.addEventListener("touchstart",i,!1),this._isTouchLocked=e},n.prototype.handlePageVisibility=function(){s.onPageHidden.add(this.pauseAll,this),s.onPageShown.add(this.resumeAll,this)},n.prototype.log=function(t){var e="Sono "+this.VERSION,n="Supported:"+this.isSupported+" WebAudioAPI:"+this.hasWebAudio+" TouchLocked:"+this._isTouchLocked+" Extensions:"+this.getSupportedExtensions();if(t&&navigator.userAgent.indexOf("Chrome")>-1){var i=["%c %c "+e+" %c %c "+n+" %c ","background: #17d186","color: #000000; background: #d0f736; font-weight: bold","background: #17d186","background: #f7f94f","background: #17d186"];console.log.apply(console,i)}else window.console},Object.defineProperty(n.prototype,"isSupported",{get:function(){return this.getSupportedExtensions().length>0}}),Object.defineProperty(n.prototype,"hasWebAudio",{get:function(){return!!this.context}}),Object.defineProperty(n.prototype,"volume",{get:function(){return this.hasWebAudio?this._masterGain.gain.value:this._masterGain},set:function(t){if(!isNaN(t))if(this.hasWebAudio)this._masterGain.gain.value=t;else{this._masterGain=t;for(var e in this._sounds)this._sounds[e].volume=this._masterGain}}}),Object.defineProperty(n.prototype,"create",{get:function(){return this._webAudioNodeFactory||(this._webAudioNodeFactory=new r(this.context)),this._webAudioNodeFactory}}),Object.defineProperty(n.prototype,"utils",{get:function(){return this._utils||(this._utils=new a(this.context)),this._utils}}),Object.defineProperty(n.prototype,"loader",{get:function(){return this._loader}}),"object"==typeof e&&e.exports&&(e.exports=new n)},{"./lib/asset-loader.js":2,"./lib/html-sound.js":3,"./lib/page-visibility.js":4,"./lib/webaudio-nodefactory.js":5,"./lib/webaudio-player.js":6,"./lib/webaudio-utils.js":8}]},{},[9])(9)});