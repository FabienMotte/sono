!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Sono=t()}}(function(){var t;return function e(t,n,o){function i(s,u){if(!n[s]){if(!t[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return i(n?n:e)},d,d.exports,e,t,n,o)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<o.length;s++)i(o[s]);return i}({1:[function(t,e){"use strict";function n(){this.VERSION="0.0.0",window.AudioContext=window.AudioContext||window.webkitAudioContext,this._context=window.AudioContext?new window.AudioContext:null,u.setContext(this._context),this._node=new i(this._context),this._masterGain=this._node.gain(),this._context&&(this._node.setSource(this._masterGain),this._node.setDestination(this._context.destination)),this._sounds=[],this._handleTouchlock(),this._handleVisibility()}var o=t("./lib/loader.js"),i=t("./lib/node-manager.js"),r=t("./lib/sound.js"),s=t("./lib/support.js"),u=t("./lib/utils.js");n.prototype.createSound=function(t){if(s.containsURL(t))return this.load(t);var e=new r(this._context,this._masterGain);return t&&(e.setData(t.data||t),e.id=t.id||"",e.loop=!!t.loop,e.volume=t.volume),this._sounds.push(e),e},n.prototype.destroy=function(t){t&&this._sounds.some(function(e,n,o){if(e===t||e.id===t){o.splice(n,1),e.loader&&e.loader.cancel();try{e.stop()}catch(i){}return!0}})},n.prototype.getById=function(t){var e=null;return this._sounds.some(function(n){return e=n,e.id===t}),e},n.prototype.load=function(t,e){e=e||{};var n,i,r=!!e.asMediaElement,s=e.onProgress,u=e.onComplete,a=e.thisArg||e.context||this;return Array.isArray(t)&&t[0].hasOwnProperty("url")?(n=[],i=new o.Group,t.forEach(function(t){n.push(this._queue(t,r,i))},this)):(n=this._queue(t,r),i=n.loader),s&&i.onProgress.add(s,a),u&&i.onComplete.addOnce(function(){u.call(a,n)}),i.start(),n},n.prototype._queue=function(t,e,n){var i=s.getSupportedFile(t.url||t),r=this.createSound();r.id=t.id||"",r.loop=!!t.loop,r.volume=t.volume;var u=new o(i);return u.audioContext=e?null:this._context,u.isTouchLocked=this._isTouchLocked,u.onBeforeComplete.addOnce(function(t){r.setData(t)}),r.loader=u,n&&n.add(u),r},n.prototype.mute=function(){this._preMuteVolume=this.volume,this.volume=0},n.prototype.unMute=function(){this.volume=this._preMuteVolume||1},Object.defineProperty(n.prototype,"volume",{get:function(){return this._masterGain.gain.value},set:function(t){isNaN(t)||(this._masterGain.gain.value=t,this.hasWebAudio||this._sounds.forEach(function(e){e.volume=t}))}}),n.prototype.pauseAll=function(){this._sounds.forEach(function(t){t.playing&&t.pause()})},n.prototype.resumeAll=function(){this._sounds.forEach(function(t){t.paused&&t.play()})},n.prototype.stopAll=function(){this._sounds.forEach(function(t){t.stop()})},n.prototype.play=function(t,e,n){this.getById(t).play(e,n)},n.prototype.pause=function(t){this.getById(t).pause()},n.prototype.stop=function(t){this.getById(t).stop()},n.prototype._handleTouchlock=function(){var t=navigator.userAgent,e=!!t.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i),n=this,o=function(){if(document.body.removeEventListener("touchstart",o),n._isTouchLocked=!1,n._sounds.forEach(function(t){t.loader&&(t.loader.touchLocked=!1)}),n.context){var t=n.context.createBuffer(1,1,22050),e=n.context.createBufferSource();e.buffer=t,e.connect(n.context.destination),e.start(0)}};e&&document.body.addEventListener("touchstart",o,!1),this._isTouchLocked=e},n.prototype._handleVisibility=function(){function t(){s.forEach(function(t){t.playing&&(t.pause(),r.push(t))})}function e(){for(;r.length;)r.pop().play()}function n(){document[o]?t():e()}var o,i,r=[],s=this._sounds;"undefined"!=typeof document.hidden?(o="hidden",i="visibilitychange"):"undefined"!=typeof document.mozHidden?(o="mozHidden",i="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(o="msHidden",i="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(o="webkitHidden",i="webkitvisibilitychange"),void 0!==i&&document.addEventListener(i,n,!1)},n.prototype.log=function(){var t="Sono "+this.VERSION,e="Supported:"+this.isSupported+" WebAudioAPI:"+this.hasWebAudio+" TouchLocked:"+this._isTouchLocked+" Extensions:"+s.extensions;if(navigator.userAgent.indexOf("Chrome")>-1){var n=["%c ♫ "+t+" ♫ %c "+e+" ","color: #FFFFFF; background: #379F7A","color: #1F1C0D; background: #E0FBAC"];console.log.apply(console,n)}else window.console&&window.console.log.call&&console.log.call(console,t+" "+e)},Object.defineProperty(n.prototype,"canPlay",{get:function(){return s.canPlay}}),Object.defineProperty(n.prototype,"context",{get:function(){return this._context}}),Object.defineProperty(n.prototype,"hasWebAudio",{get:function(){return!!this._context}}),Object.defineProperty(n.prototype,"isSupported",{get:function(){return s.extensions.length>0}}),Object.defineProperty(n.prototype,"masterGain",{get:function(){return this._masterGain}}),Object.defineProperty(n.prototype,"node",{get:function(){return this._node}}),Object.defineProperty(n.prototype,"sounds",{get:function(){return this._sounds}}),Object.defineProperty(n.prototype,"utils",{get:function(){return u}}),e.exports=new n},{"./lib/loader.js":3,"./lib/node-manager.js":4,"./lib/sound.js":13,"./lib/support.js":19,"./lib/utils.js":20}],2:[function(e,n){!function(e){function o(t,e,n,o,i){this._listener=e,this._isOnce=n,this.context=o,this._signal=t,this._priority=i||0}function i(t,e){if("function"!=typeof t)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",e))}function r(){this._bindings=[],this._prevParams=null;var t=this;this.dispatch=function(){r.prototype.dispatch.apply(t,arguments)}}o.prototype={active:!0,params:null,execute:function(t){var e,n;return this.active&&this._listener&&(n=this.params?this.params.concat(t):t,e=this._listener.apply(this.context,n),this._isOnce&&this.detach()),e},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},r.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(t,e,n,i){var r,s=this._indexOfListener(t,n);if(-1!==s){if(r=this._bindings[s],r.isOnce()!==e)throw new Error("You cannot add"+(e?"":"Once")+"() then add"+(e?"Once":"")+"() the same listener without removing the relationship first.")}else r=new o(this,t,e,n,i),this._addBinding(r);return this.memorize&&this._prevParams&&r.execute(this._prevParams),r},_addBinding:function(t){var e=this._bindings.length;do--e;while(this._bindings[e]&&t._priority<=this._bindings[e]._priority);this._bindings.splice(e+1,0,t)},_indexOfListener:function(t,e){for(var n,o=this._bindings.length;o--;)if(n=this._bindings[o],n._listener===t&&n.context===e)return o;return-1},has:function(t,e){return-1!==this._indexOfListener(t,e)},add:function(t,e,n){return i(t,"add"),this._registerListener(t,!1,e,n)},addOnce:function(t,e,n){return i(t,"addOnce"),this._registerListener(t,!0,e,n)},remove:function(t,e){i(t,"remove");var n=this._indexOfListener(t,e);return-1!==n&&(this._bindings[n]._destroy(),this._bindings.splice(n,1)),t},removeAll:function(){for(var t=this._bindings.length;t--;)this._bindings[t]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var t,e=Array.prototype.slice.call(arguments),n=this._bindings.length;if(this.memorize&&(this._prevParams=e),n){t=this._bindings.slice(),this._shouldPropagate=!0;do n--;while(t[n]&&this._shouldPropagate&&t[n].execute(e)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var s=r;s.Signal=r,"function"==typeof t&&t.amd?t(function(){return s}):"undefined"!=typeof n&&n.exports?n.exports=s:e.signals=s}(this)},{}],3:[function(t,e){"use strict";function n(t){var e,n,i,r,s=new o.Signal,u=new o.Signal,a=new o.Signal,c=new o.Signal,d=0,h=function(){e?p():f()},p=function(){i=new XMLHttpRequest,i.open("GET",t,!0),i.responseType="arraybuffer",i.onprogress=function(t){t.lengthComputable&&(d=t.loaded/t.total,s.dispatch(d))},i.onload=function(){e.decodeAudioData(i.response,function(t){r=t,d=1,s.dispatch(1),u.dispatch(t),a.dispatch(t)},function(t){c.dispatch(t)})},i.onerror=function(t){c.dispatch(t)},i.send()},f=function(){if(r=new Audio,r.name=t,r.preload="auto",r.src=t,n)s.dispatch(1),u.dispatch(r),a.dispatch(r);else{var e,o=function(){r.removeEventListener("canplaythrough",o),window.clearTimeout(e),d=1,s.dispatch(1),u.dispatch(r),a.dispatch(r)};e=window.setTimeout(o,4e3),r.addEventListener("canplaythrough",o,!1),r.onerror=function(t){window.clearTimeout(e),c.dispatch(t)},r.load()}},l=function(){i&&4!==i.readyState&&i.abort()},_={start:h,cancel:l,onProgress:s,onComplete:a,onBeforeComplete:u,onError:c};return Object.defineProperty(_,"data",{get:function(){return r}}),Object.defineProperty(_,"progress",{get:function(){return d}}),Object.defineProperty(_,"audioContext",{set:function(t){e=t}}),Object.defineProperty(_,"isTouchLocked",{set:function(t){n=t}}),Object.freeze(_)}var o=t("signals");n.Group=function(){var t=[],e=0,n=0,i=new o.Signal,r=new o.Signal,s=new o.Signal,u=function(e){return t.push(e),n++,e},a=function(){n=t.length,c()},c=function(){if(0===t.length)return void i.dispatch();var e=t.pop();e.onProgress.add(d),e.onBeforeComplete.addOnce(h),e.onError.addOnce(p),e.start()},d=function(t){var e=e+t;r.getNumListeners()>0&&r.dispatch(e/n)},h=function(){e++,r.getNumListeners()>0&&r.dispatch(e/n),c()},p=function(t){s.dispatch(t),c()};return Object.freeze({add:u,start:a,onProgress:r,onComplete:i,onError:s})},e.exports=n},{signals:2}],4:[function(t,e){"use strict";function n(t){this._context=t||this.createFakeContext(),this._destination=null,this._nodeList=[],this._sourceNode=null}var o=t("./node/analyser.js"),i=t("./node/distortion.js"),r=t("./node/echo.js"),s=t("./node/filter.js"),u=t("./node/panner.js"),a=t("./node/phaser.js"),c=t("./node/recorder.js"),d=t("./node/reverb.js");n.prototype.add=function(t){return this._nodeList.push(t),this._updateConnections(),t},n.prototype.remove=function(t){for(var e=this._nodeList.length,n=0;e>n;n++)t===this._nodeList[n]&&this._nodeList.splice(n,1);var o=t._out||t;return o.disconnect(),this._updateConnections(),t},n.prototype.removeAll=function(){for(;this._nodeList.length;)this._nodeList.pop().disconnect();return this._updateConnections(),this},n.prototype._connect=function(t,e){var n=t._out||t;n.disconnect(),n.connect(e._in||e),"function"==typeof t._connected&&t._connected.call(t)},n.prototype._connectTo=function(t){var e=this._nodeList.length,n=e?this._nodeList[e-1]:this._sourceNode;n&&this._connect(n,t),this._destination=t},n.prototype._updateConnections=function(){if(this._sourceNode){for(var t,e=this._nodeList.length,n=0;e>n;n++)if(t=this._nodeList[n],0===n)this._connect(this._sourceNode,t);else{var o=this._nodeList[n-1];this._connect(o,t)}this._destination&&this._connectTo(this._destination)}},Object.defineProperty(n.prototype,"panning",{get:function(){return this._panning||(this._panning=new u(this._context)),this._panning}}),n.prototype.analyser=function(t,e,n,i){var r=new o(this._context,t,e,n,i);return this.add(r)},n.prototype.compressor=function(t,e,n,o,i,r){var s=this._context.createDynamicsCompressor();return s.threshold.value=void 0!==t?t:-24,s.knee.value=void 0!==e?e:30,s.ratio.value=void 0!==n?n:12,s.reduction.value=void 0!==o?o:-10,s.attack.value=void 0!==i?i:3e-4,s.release.value=void 0!==r?r:.25,this.add(s)},n.prototype.convolver=function(t){var e=this._context.createConvolver();return e.buffer=t,this.add(e)},n.prototype.delay=function(t){var e=this._context.createDelay();return void 0!==t&&(e.delayTime.value=t),this.add(e)},n.prototype.echo=function(t,e){var n=new r(this._context,t,e);return this.add(n),n},n.prototype.distortion=function(t){var e=new i(this._context,t);return this.add(e)},n.prototype.filter=function(t,e,n,o){var i=new s(this._context,t,e,n,o);return this.add(i)},n.prototype.lowpass=function(t,e,n){return this.filter("lowpass",t,e,n)},n.prototype.highpass=function(t,e,n){return this.filter("highpass",t,e,n)},n.prototype.bandpass=function(t,e,n){return this.filter("bandpass",t,e,n)},n.prototype.lowshelf=function(t,e,n){return this.filter("lowshelf",t,e,n)},n.prototype.highshelf=function(t,e,n){return this.filter("highshelf",t,e,n)},n.prototype.peaking=function(t,e,n){return this.filter("peaking",t,e,n)},n.prototype.notch=function(t,e,n){return this.filter("notch",t,e,n)},n.prototype.allpass=function(t,e,n){return this.filter("allpass",t,e,n)},n.prototype.gain=function(t){var e=this._context.createGain();return void 0!==t&&(e.gain.value=t),e},n.prototype.panner=function(){var t=new u(this._context);return this.add(t),t},n.prototype.phaser=function(){var t=new a(this._context);return this.add(t),t},n.prototype.recorder=function(t){var e=new c(this._context,t);return this.add(e),e},n.prototype.reverb=function(t,e,n){var o=new d(this._context,t,e,n);return this.add(o),o},n.prototype.scriptProcessor=function(t,e,n,o,i){t=t||1024,e=void 0===e?0:e,n=void 0===n?1:n;var r=this._context.createScriptProcessor(t,e,n);return r.onaudioprocess=function(t){o.call(i||this,t)},this.add(r)},n.prototype.createFakeContext=function(){var t=function(){},e={value:1,defaultValue:1,linearRampToValueAtTime:t,setValueAtTime:t,exponentialRampToValueAtTime:t,setTargetAtTime:t,setValueCurveAtTime:t,cancelScheduledValues:t},n={connect:t,disconnect:t,gain:{value:1},panningModel:0,setPosition:t,setOrientation:t,setVelocity:t,distanceModel:0,refDistance:0,maxDistance:0,rolloffFactor:0,coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,type:0,frequency:e,delayTime:e,buffer:0,smoothingTimeConstant:0,fftSize:0,minDecibels:0,maxDecibels:0,threshold:e,knee:e,ratio:e,attack:e,release:e,oversample:0,curve:0,sampleRate:1,length:0,duration:0,numberOfChannels:0,getChannelData:function(){return[]},copyFromChannel:t,copyToChannel:t},o=function(){return n};return{createAnalyser:o,createBuffer:o,createBiquadFilter:o,createDynamicsCompressor:o,createConvolver:o,createDelay:o,createGain:function(){return{gain:{value:1,defaultValue:1,linearRampToValueAtTime:t,setValueAtTime:t,exponentialRampToValueAtTime:t,setTargetAtTime:t,setValueCurveAtTime:t,cancelScheduledValues:t},connect:t,disconnect:t}},createPanner:o,createScriptProcessor:o,createWaveShaper:o}},n.prototype.setSource=function(t){return this._sourceNode=t,this._updateConnections(),t},n.prototype.setDestination=function(t){return this._connectTo(t),t},"object"==typeof e&&e.exports&&(e.exports=n)},{"./node/analyser.js":5,"./node/distortion.js":6,"./node/echo.js":7,"./node/filter.js":8,"./node/panner.js":9,"./node/phaser.js":10,"./node/recorder.js":11,"./node/reverb.js":12}],5:[function(t,e){"use strict";function n(t,e,n,o,i){e=e||32;var r,s,u=t.createAnalyser();u.fftSize=e,void 0!==n&&(u.smoothingTimeConstant=n),void 0!==o&&(u.minDecibels=o),void 0!==i&&(u.maxDecibels=i);var a=function(){(e!==u.fftSize||void 0===r)&&(r=new Uint8Array(u.fftSize),s=new Uint8Array(u.frequencyBinCount),e=u.fftSize)};return a(),u.getWaveform=function(){return a(),this.getByteTimeDomainData(r),r},u.getFrequencies=function(){return a(),this.getByteFrequencyData(s),s},Object.defineProperties(u,{smoothing:{get:function(){return u.smoothingTimeConstant},set:function(t){u.smoothingTimeConstant=t}}}),u}"object"==typeof e&&e.exports&&(e.exports=n)},{}],6:[function(t,e){"use strict";function n(t,e){var n=t.createWaveShaper();return n.update=function(t){e=t;for(var n=100*t,o=22050,i=new Float32Array(o),r=Math.PI/180,s=0;o>s;s++){var u=2*s/o-1;i[s]=(3+n)*u*20*r/(Math.PI+n*Math.abs(u))}this.curve=i},Object.defineProperties(n,{amount:{get:function(){return e},set:function(t){this.update(t)}}}),void 0!==e&&n.update(e),n}"object"==typeof e&&e.exports&&(e.exports=n)},{}],7:[function(t,e){"use strict";function n(t,e,n){var o=t.createDelay(),i=t.createGain();return i.gain.value=n||.5,void 0!==e&&(o.delayTime.value=e),o._connected=function(){o.connect(i),i.connect(o)},o.update=function(t,e){void 0!==t&&(this.delayTime.value=t),void 0!==e&&(i.gain.value=e)},o}"object"==typeof e&&e.exports&&(e.exports=n)},{}],8:[function(t,e){"use strict";function n(t,e,n,o,i){var r=40,s=t.sampleRate/2,u=t.createBiquadFilter();u.type=e,void 0!==n&&(u.frequency.value=n),void 0!==o&&(u.Q.value=o),void 0!==i&&(u.gain.value=i);var a=function(t){var e=Math.log(s/r)/Math.LN2,n=Math.pow(2,e*(t-1));return s*n};return u.update=function(t,e){void 0!==t&&(this.frequency.value=t),void 0!==e&&(this.gain.value=e)},u.setByPercent=function(t,e,n){u.frequency.value=a(t),void 0!==e&&(u.Q.value=e),void 0!==n&&(u.gain.value=n)},u}"object"==typeof e&&e.exports&&(e.exports=n)},{}],9:[function(t,e){"use strict";function n(t){var e=t.createPanner();e.panningModel=n.defaults.panningModel,e.distanceModel=n.defaults.distanceModel,e.refDistance=n.defaults.refDistance,e.maxDistance=n.defaults.maxDistance,e.rolloffFactor=n.defaults.rolloffFactor,e.coneInnerAngle=n.defaults.coneInnerAngle,e.coneOuterAngle=n.defaults.coneOuterAngle,e.coneOuterGain=n.defaults.coneOuterGain;var o={pool:[],get:function(t,e,n){var o=this.pool.length?this.pool.pop():{x:0,y:0,z:0};return void 0!==t&&isNaN(t)&&"x"in t&&"y"in t&&"z"in t?(o.x=t.x||0,o.y=t.y||0,o.z=t.z||0):(o.x=t||0,o.y=e||0,o.z=n||0),o},dispose:function(t){this.pool.push(t)}},i=o.get(0,1,0),r=function(t,e){var n=o.get(e.x,e.y,e.z);a(n,i),a(n,e),c(n),c(e),t.setOrientation(e.x,e.y,e.z,n.x,n.y,n.z),o.dispose(e),o.dispose(n)},s=function(t,e){t.setPosition(e.x,e.y,e.z),o.dispose(e)},u=function(t,e){t.setVelocity(e.x,e.y,e.z),o.dispose(e)},a=function(t,e){var n=t.x,o=t.y,i=t.z,r=e.x,s=e.y,u=e.z;t.x=o*u-i*s,t.y=i*r-n*u,t.z=n*s-o*r},c=function(t){if(0===t.x&&0===t.y&&0===t.z)return t;var e=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z),n=1/e;return t.x*=n,t.y*=n,t.z*=n,t};return e.setX=function(t){var n=Math.PI/4,o=2*n,i=t*n,r=i+o;r>o&&(r=Math.PI-r),i=Math.sin(i),r=Math.sin(r),e.setPosition(i,0,r)},e.setSourcePosition=function(t,n,i){s(e,o.get(t,n,i))},e.setSourceOrientation=function(t,n,i){r(e,o.get(t,n,i))},e.setSourceVelocity=function(t,n,i){u(e,o.get(t,n,i))},e.setListenerPosition=function(e,n,i){s(t.listener,o.get(e,n,i))},e.setListenerOrientation=function(e,n,i){r(t.listener,o.get(e,n,i))},e.setListenerVelocity=function(e,n,i){u(t.listener,o.get(e,n,i))},e.calculateVelocity=function(t,e,n){var i=t.x-e.x,r=t.y-e.y,s=t.z-e.z;return o.get(i/n,r/n,s/n)},e.setDefaults=function(t){Object.keys(t).forEach(function(e){n.defaults[e]=t[e]})},e}n.defaults={panningModel:"HRTF",distanceModel:"linear",refDistance:1,maxDistance:1e3,rolloffFactor:1,coneInnerAngle:360,coneOuterAngle:0,coneOuterGain:0},"object"==typeof e&&e.exports&&(e.exports=n)},{}],10:[function(t,e){"use strict";function n(t,e){var n,o=4,i=8,r=e||20,s=.5,u=[],a=t.createOscillator();a.type="sine",a.frequency.value=i;var c=t.createGain();c.gain.value=r,a.connect(c),a.start();var d=t.createGain();d.gain.value=s;for(var h=0;o>h;h++)n=t.createBiquadFilter(),n.type="allpass",u.push(n),h>0&&u[h-1].connect(u[h]),c.connect(u[h].frequency);var p=u[0];return p._out=u[u.length-1],p._connected=function(){console.log.apply(console,["phaser connected"]),this._out.connect(d),d.connect(p)},p}"object"==typeof e&&e.exports&&(e.exports=n)},{}],11:[function(t,e){"use strict";function n(t,e){var n=t.createScriptProcessor(4096,2,2),o=[],i=[],r=0,s=0;void 0===e&&(e=!0),n.isRecording=!1;var u=function(){var e=t.createBuffer(2,o.length,t.sampleRate);return e.getChannelData(0).set(o),e.getChannelData(1).set(i),e};return n.start=function(){o.length=0,i.length=0,r=t.currentTime,s=0,this.isRecording=!0},n.stop=function(){return s=t.currentTime,this.isRecording=!1,u()},n.getDuration=function(){return this.isRecording?t.currentTime-r:s-r},n.onaudioprocess=function(t){var n=t.inputBuffer.getChannelData(0),r=t.inputBuffer.getChannelData(0),s=t.outputBuffer.getChannelData(0),u=t.outputBuffer.getChannelData(0);if(e&&(s.set(n),u.set(r)),this.isRecording)for(var a=0;a<n.length;a++)o.push(n[a]),i.push(r[a])},n._connected=function(){this.connect(t.destination)},n}e.exports=n},{}],12:[function(t,e){"use strict";function n(t,e,n,o){var i=t.createConvolver();return i.update=function(e,n,o){e=e||1,n=n||5,o=!!o;for(var i,r,s=2,u=t.sampleRate,a=u*e,c=t.createBuffer(s,a,u),d=c.getChannelData(0),h=c.getChannelData(1),p=0;a>p;p++)i=o?a-1:p,r=Math.pow(1-i/a,n),d[p]=(2*Math.random()-1)*r,h[p]=(2*Math.random()-1)*r;this.buffer=c},i.update(e,n,o),i}"object"==typeof e&&e.exports&&(e.exports=n)},{}],13:[function(t,e){"use strict";function n(t,e){this.id="",this._context=t,this._data=null,this._endedCallback=null,this._loop=!1,this._pausedAt=0,this._playWhenReady=!1,this._source=null,this._startedAt=0,this._node=new s(this._context),this._gain=this._node.gain(),this._context&&(this._node.setDestination(this._gain),this._gain.connect(e||this._context.destination))}var o=t("./source/buffer-source.js"),i=t("./source/media-source.js"),r=t("./source/microphone-source.js"),s=t("./node-manager.js"),u=t("./source/oscillator-source.js"),a=t("./source/script-source.js"),c=t("./utils.js");n.prototype.setData=function(t){if(!t)return this;if(this._data=t,c.isAudioBuffer(t))this._source=new o(t,this._context);else if(c.isMediaElement(t))this._source=new i(t,this._context);else if(c.isMediaStream(t))this._source=new r(t,this._context);else if(c.isOscillatorType(t))this._source=new u(t,this._context);else{if(!c.isScriptConfig(t))throw new Error("Cannot detect data type: "+t);this._source=new a(t,this._context)}return this._node.setSource(this._source.sourceNode),"function"==typeof this._source.onEnded&&this._source.onEnded(this._endedHandler,this),this._playWhenReady&&this.play(),this},n.prototype.play=function(t,e){return this._source?(this._node.setSource(this._source.sourceNode),this._source.loop=this._loop,this._context||(this.volume=this.volume),this._source.play(t,e),this):(this._playWhenReady=!0,this)},n.prototype.pause=function(){return this._source?(this._source.pause(),this):this},n.prototype.stop=function(){return this._source?(this._source.stop(),this):this},n.prototype.seek=function(t){return this._source?(this.stop(),this.play(0,this._source.duration*t),this):this},n.prototype.onEnded=function(t,e){return this._endedCallback=t?t.bind(e||this):null,this},n.prototype._endedHandler=function(){"function"==typeof this._endedCallback&&this._endedCallback(this)},Object.defineProperty(n.prototype,"context",{get:function(){return this._context}}),Object.defineProperty(n.prototype,"currentTime",{get:function(){return this._source?this._source.currentTime:0}}),Object.defineProperty(n.prototype,"data",{get:function(){return this._data}}),Object.defineProperty(n.prototype,"duration",{get:function(){return this._source?this._source.duration:0}}),Object.defineProperty(n.prototype,"ended",{get:function(){return this._source?this._source.ended:!1}}),Object.defineProperty(n.prototype,"gain",{get:function(){return this._gain}}),Object.defineProperty(n.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=!!t,this._source&&(this._source.loop=this._loop)}}),Object.defineProperty(n.prototype,"node",{get:function(){return this._node}}),Object.defineProperty(n.prototype,"paused",{get:function(){return this._source?this._source.paused:!1}}),Object.defineProperty(n.prototype,"playing",{get:function(){return this._source?this._source.playing:!1}}),Object.defineProperty(n.prototype,"progress",{get:function(){return this._source?this._source.progress:0}}),Object.defineProperty(n.prototype,"volume",{get:function(){return this._gain.gain.value},set:function(t){isNaN(t)||(this._gain.gain.value=t,this._data&&void 0!==this._data.volume&&(this._data.volume=t))}}),Object.defineProperty(n.prototype,"frequency",{get:function(){return this._source?this._source.frequency:0},set:function(t){this._source&&(this._source.frequency=t)}}),"object"==typeof e&&e.exports&&(e.exports=n)},{"./node-manager.js":4,"./source/buffer-source.js":14,"./source/media-source.js":15,"./source/microphone-source.js":16,"./source/oscillator-source.js":17,"./source/script-source.js":18,"./utils.js":20}],14:[function(t,e){"use strict";function n(t,e){this.id="",this._buffer=t,this._context=e,this._ended=!1,this._endedCallback=null,this._loop=!1,this._paused=!1,this._pausedAt=0,this._playing=!1,this._sourceNode=null,this._startedAt=0}n.prototype.play=function(t,e){if(!this._playing){for(void 0===t&&(t=0),t>0&&(t=this._context.currentTime+t),void 0===e&&(e=0),this._pausedAt>0&&(e+=this._pausedAt),console.log.apply(console,["1 offset:",e]);e>this.duration;)e%=this.duration;console.log.apply(console,["2 offset:",e]),this.sourceNode.loop=this._loop,this.sourceNode.onended=this._endedHandler.bind(this),this.sourceNode.start(t,e),this._startedAt=this._pausedAt?this._context.currentTime-this._pausedAt:this._context.currentTime-e,this._ended=!1,this._paused=!1,this._pausedAt=0,this._playing=!0}},n.prototype.pause=function(){var t=this._context.currentTime-this._startedAt;this.stop(),this._pausedAt=t,this._playing=!1,this._paused=!0},n.prototype.stop=function(){if(this._sourceNode){this._sourceNode.onended=null;try{this._sourceNode.disconnect(),this._sourceNode.stop(0)}catch(t){}this._sourceNode=null}this._paused=!1,this._pausedAt=0,this._playing=!1,this._startedAt=0},n.prototype.onEnded=function(t,e){this._endedCallback=t?t.bind(e||this):null},n.prototype._endedHandler=function(){this.stop(),this._ended=!0,"function"==typeof this._endedCallback&&this._endedCallback(this)},Object.defineProperty(n.prototype,"currentTime",{get:function(){return this._pausedAt?this._pausedAt:this._startedAt?this._context.currentTime-this._startedAt:0}}),Object.defineProperty(n.prototype,"duration",{get:function(){return this._buffer?this._buffer.duration:0}}),Object.defineProperty(n.prototype,"ended",{get:function(){return this._ended}}),Object.defineProperty(n.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=!!t}}),Object.defineProperty(n.prototype,"paused",{get:function(){return this._paused}}),Object.defineProperty(n.prototype,"playing",{get:function(){return this._playing}}),Object.defineProperty(n.prototype,"progress",{get:function(){return Math.min(this.currentTime/this.duration,1)}}),Object.defineProperty(n.prototype,"sourceNode",{get:function(){return this._sourceNode||(this._sourceNode=this._context.createBufferSource(),this._sourceNode.buffer=this._buffer),this._sourceNode}}),"object"==typeof e&&e.exports&&(e.exports=n)},{}],15:[function(t,e){"use strict";function n(t,e){this.id="",this._context=e,this._el=t,this._ended=!1,this._endedCallback=null,this._endedHandlerBound=this._endedHandler.bind(this),this._loop=!1,this._paused=!1,this._playing=!1,this._sourceNode=null}n.prototype.play=function(t,e){clearTimeout(this._delayTimeout),this.volume=this._volume,e&&(this._el.currentTime=e),t?this._delayTimeout=setTimeout(this.play.bind(this),t):this._el.play(),this._ended=!1,this._paused=!1,this._playing=!0,this._el.removeEventListener("ended",this._endedHandlerBound),this._el.addEventListener("ended",this._endedHandlerBound,!1)},n.prototype.pause=function(){clearTimeout(this._delayTimeout),this._el&&(this._el.pause(),this._playing=!1,this._paused=!0)},n.prototype.stop=function(){if(clearTimeout(this._delayTimeout),this._el){this._el.pause();try{this._el.currentTime=0,this._el.currentTime>0&&this._el.load()}catch(t){}this._playing=!1,this._paused=!1}},n.prototype.onEnded=function(t,e){this._endedCallback=t?t.bind(e||this):null},n.prototype._endedHandler=function(){this._ended=!0,this._paused=!1,this._playing=!1,this._loop?(this._el.currentTime=0,this._el.currentTime>0&&this._el.load(),this.play()):"function"==typeof this._endedCallback&&this._endedCallback(this)},Object.defineProperty(n.prototype,"currentTime",{get:function(){return this._el?this._el.currentTime:0}}),Object.defineProperty(n.prototype,"duration",{get:function(){return this._el?this._el.duration:0}}),Object.defineProperty(n.prototype,"ended",{get:function(){return this._ended}}),Object.defineProperty(n.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t}}),Object.defineProperty(n.prototype,"paused",{get:function(){return this._paused}}),Object.defineProperty(n.prototype,"playing",{get:function(){return this._playing}}),Object.defineProperty(n.prototype,"progress",{get:function(){return this.currentTime/this.duration}}),Object.defineProperty(n.prototype,"sourceNode",{get:function(){return!this._sourceNode&&this._context&&(this._sourceNode=this._context.createMediaElementSource(this._el)),this._sourceNode}}),"object"==typeof e&&e.exports&&(e.exports=n)},{}],16:[function(t,e){"use strict";function n(t,e){this.id="",this._context=e,this._ended=!1,this._paused=!1,this._pausedAt=0,this._playing=!1,this._sourceNode=null,this._startedAt=0,this._stream=t}n.prototype.play=function(t){void 0===t&&(t=0),t>0&&(t=this._context.currentTime+t),this.sourceNode.start(t),this._startedAt=this._pausedAt?this._context.currentTime-this._pausedAt:this._context.currentTime,this._ended=!1,this._playing=!0,this._paused=!1,this._pausedAt=0},n.prototype.pause=function(){var t=this._context.currentTime-this._startedAt;this.stop(),this._pausedAt=t,this._playing=!1,this._paused=!0},n.prototype.stop=function(){if(this._sourceNode){try{this._sourceNode.stop(0)}catch(t){}this._sourceNode=null}this._ended=!0,this._paused=!1,this._pausedAt=0,this._playing=!1,this._startedAt=0},Object.defineProperty(n.prototype,"currentTime",{get:function(){return this._pausedAt?this._pausedAt:this._startedAt?this._context.currentTime-this._startedAt:0}}),Object.defineProperty(n.prototype,"duration",{get:function(){return 0}}),Object.defineProperty(n.prototype,"ended",{get:function(){return this._ended}}),Object.defineProperty(n.prototype,"paused",{get:function(){return this._paused}}),Object.defineProperty(n.prototype,"playing",{get:function(){return this._playing}}),Object.defineProperty(n.prototype,"progress",{get:function(){return 0}}),Object.defineProperty(n.prototype,"sourceNode",{get:function(){return this._sourceNode||(this._sourceNode=this._context.createMediaStreamSource(this._stream),navigator.mozGetUserMedia&&(window.mozHack=this._sourceNode)),this._sourceNode}}),"object"==typeof e&&e.exports&&(e.exports=n)},{}],17:[function(t,e){"use strict";function n(t,e){this.id="",this._context=e,this._ended=!1,this._paused=!1,this._pausedAt=0,this._playing=!1,this._sourceNode=null,this._startedAt=0,this._type=t,this._frequency=200}n.prototype.play=function(t){void 0===t&&(t=0),t>0&&(t=this._context.currentTime+t),this.sourceNode.start(t),this._startedAt=this._pausedAt?this._context.currentTime-this._pausedAt:this._context.currentTime,this._ended=!1,this._playing=!0,this._paused=!1,this._pausedAt=0},n.prototype.pause=function(){var t=this._context.currentTime-this._startedAt;this.stop(),this._pausedAt=t,this._playing=!1,this._paused=!0},n.prototype.stop=function(){if(this._sourceNode){try{this._sourceNode.stop(0)}catch(t){}this._sourceNode=null}this._ended=!0,this._paused=!1,this._pausedAt=0,this._playing=!1,this._startedAt=0
},Object.defineProperty(n.prototype,"frequency",{get:function(){return this._frequency},set:function(t){this._frequency=t,this._sourceNode&&(this._sourceNode.frequency.value=t)}}),Object.defineProperty(n.prototype,"currentTime",{get:function(){return this._pausedAt?this._pausedAt:this._startedAt?this._context.currentTime-this._startedAt:0}}),Object.defineProperty(n.prototype,"duration",{get:function(){return 0}}),Object.defineProperty(n.prototype,"ended",{get:function(){return this._ended}}),Object.defineProperty(n.prototype,"paused",{get:function(){return this._paused}}),Object.defineProperty(n.prototype,"playing",{get:function(){return this._playing}}),Object.defineProperty(n.prototype,"progress",{get:function(){return 0}}),Object.defineProperty(n.prototype,"sourceNode",{get:function(){return!this._sourceNode&&this._context&&(this._sourceNode=this._context.createOscillator(),this._sourceNode.type=this._type,this._sourceNode.frequency.value=this._frequency),this._sourceNode}}),"object"==typeof e&&e.exports&&(e.exports=n)},{}],18:[function(t,e){"use strict";function n(t,e){this.id="",this._bufferSize=t.bufferSize||1024,this._channels=t.channels||1,this._context=e,this._ended=!1,this._onProcess=t.callback.bind(t.thisArg||this),this._paused=!1,this._pausedAt=0,this._playing=!1,this._sourceNode=null,this._startedAt=0}n.prototype.play=function(t){void 0===t&&(t=0),t>0&&(t=this._context.currentTime+t),this.sourceNode.onaudioprocess=this._onProcess,this._startedAt=this._pausedAt?this._context.currentTime-this._pausedAt:this._context.currentTime,this._ended=!1,this._paused=!1,this._pausedAt=0,this._playing=!0},n.prototype.pause=function(){var t=this._context.currentTime-this._startedAt;this.stop(),this._pausedAt=t,this._playing=!1,this._paused=!0},n.prototype.stop=function(){this._sourceNode&&(this._sourceNode.onaudioprocess=this._onPaused),this._ended=!0,this._paused=!1,this._pausedAt=0,this._playing=!1,this._startedAt=0},n.prototype._onPaused=function(t){for(var e=t.outputBuffer,n=0,o=e.numberOfChannels;o>n;n++)for(var i=e.getChannelData(n),r=0,s=i.length;s>r;r++)i[r]=0},Object.defineProperty(n.prototype,"currentTime",{get:function(){return this._pausedAt?this._pausedAt:this._startedAt?this._context.currentTime-this._startedAt:0}}),Object.defineProperty(n.prototype,"duration",{get:function(){return 0}}),Object.defineProperty(n.prototype,"ended",{get:function(){return this._ended}}),Object.defineProperty(n.prototype,"paused",{get:function(){return this._paused}}),Object.defineProperty(n.prototype,"playing",{get:function(){return this._playing}}),Object.defineProperty(n.prototype,"progress",{get:function(){return 0}}),Object.defineProperty(n.prototype,"sourceNode",{get:function(){return this._sourceNode||(this._sourceNode=this._context.createScriptProcessor(this._bufferSize,0,this._channels)),this._sourceNode}}),"object"==typeof e&&e.exports&&(e.exports=n)},{}],19:[function(t,e){"use strict";function n(){var t=[],e={},n=document.createElement("audio");if(n){var o=[{ext:"ogg",type:'audio/ogg; codecs="vorbis"'},{ext:"mp3",type:"audio/mpeg;"},{ext:"opus",type:'audio/ogg; codecs="opus"'},{ext:"wav",type:'audio/wav; codecs="1"'},{ext:"m4a",type:"audio/x-m4a;"},{ext:"m4a",type:"audio/aac;"}];o.forEach(function(o){var i=!!n.canPlayType(o.type);i&&t.push(o.ext),e[o.ext]=i});var i=function(t){t=t.split("?")[0],t=t.substr(t.lastIndexOf("/")+1);var e=t.split(".");return 1===e.length||""===e[0]&&2===e.length?"":e.pop().toLowerCase()},r=function(e){var n;return Array.isArray(e)?e.some(function(e){n=e;var o=i(e);return t.indexOf(o)>-1},this):"object"==typeof e&&Object.keys(e).some(function(o){n=e[o];var r=i(n);return t.indexOf(r)>-1},this),n||e},s=function(t){if(!t)return!1;var e=t.url||t;return u(e)||Array.isArray(e)&&u(e[0])},u=function(t){return!!(t&&"string"==typeof t&&t.indexOf(".")>-1)};return Object.freeze({extensions:t,canPlay:e,getFileExtension:i,getSupportedFile:r,containsURL:s})}}e.exports=new n},{}],20:[function(t,e){"use strict";var n={};n.setContext=function(t){this._context=t},n.cloneBuffer=function(t){for(var e=t.numberOfChannels,n=this._context.createBuffer(e,t.length,t.sampleRate),o=0;e>o;o++)n.getChannelData(o).set(t.getChannelData(o));return n},n.reverseBuffer=function(t){for(var e=t.numberOfChannels,n=0;e>n;n++)Array.prototype.reverse.call(t.getChannelData(n));return t},n.crossFade=function(t,e,n){var o=this.isAudioParam(t)?t:t.gain.gain,i=this.isAudioParam(e)?e:e.gain.gain;o.setValueAtTime(o.value,0),o.linearRampToValueAtTime(0,this._context.currentTime+n),i.setValueAtTime(i.value,0),i.linearRampToValueAtTime(1,this._context.currentTime+n)},n.fadeFrom=function(t,e,n){var o=this.isAudioParam(t)?t:t.gain.gain,i=o.value;o.setValueAtTime(e,0),o.linearRampToValueAtTime(i,this._context.currentTime+n)},n.fadeTo=function(t,e,n){var o=this.isAudioParam(t)?t:t.gain.gain;o.setValueAtTime(o.value,0),o.linearRampToValueAtTime(e,this._context.currentTime+n)},n.getFrequency=function(t){var e=40,n=this._context.sampleRate/2,o=Math.log(n/e)/Math.LN2,i=Math.pow(2,o*(t-1));return n*i},n.isAudioBuffer=function(t){return!!(t&&window.AudioBuffer&&t instanceof window.AudioBuffer)},n.isMediaElement=function(t){return!!(t&&window.HTMLMediaElement&&t instanceof window.HTMLMediaElement)},n.isMediaStream=function(t){return!!(t&&"function"==typeof t.getAudioTracks&&t.getAudioTracks().length&&window.MediaStreamTrack&&t.getAudioTracks()[0]instanceof window.MediaStreamTrack)},n.isOscillatorType=function(t){return!(!t||"string"!=typeof t||"sine"!==t&&"square"!==t&&"sawtooth"!==t&&"triangle"!==t)},n.isScriptConfig=function(t){return!!(t&&"object"==typeof t&&t.bufferSize&&t.channels&&t.callback)},n.isAudioParam=function(t){return!!(t&&window.AudioParam&&t instanceof window.AudioParam)},n.microphone=function(t,e,o,i){return new n.Microphone(t,e,o,i)},n.timeCode=function(t,e){void 0===e&&(e=":");var n=Math.floor(t/3600),o=Math.floor(t%3600/60),i=Math.floor(t%3600%60),r=0===n?"":10>n?"0"+n+e:n+e,s=(10>o?"0"+o:o)+e,u=10>i?"0"+i:i;return r+s+u},n.waveform=function(t,e){return new n.Waveform(t,e)},n.Waveform=function(t,e){this.data=this.getData(t,e)},n.Waveform.prototype={getData:function(t,e){if(!window.Float32Array||!n.isAudioBuffer(t))return[];console.log("-------------------"),console.time("waveformData");var o=new Float32Array(e),i=Math.floor(t.length/e),r=5,s=Math.floor(i/r),u=0;1>s&&(s=1);for(var a=0,c=t.numberOfChannels;c>a;a++)for(var d=t.getChannelData(a),h=0;e>h;h++)for(var p=h*i,f=p+i;f>p;p+=s){var l=d[p];0>l&&(l=-l),l>o[h]&&(o[h]=l),l>u&&(u=l)}var _=1/u,y=o.length;for(a=0;y>a;a++)o[a]*=_;return console.timeEnd("waveformData"),o},getCanvas:function(t,e,n,o){var i=o||document.createElement("canvas"),r=i.width=this.data.length;i.height=t;var s=i.getContext("2d");s.strokeStyle=e,s.fillStyle=n,s.fillRect(0,0,r,t);var u,a;s.beginPath();for(var c=0,d=this.data.length;d>c;c++)u=c+.5,a=t-Math.round(t*this.data[c]),s.moveTo(u,a),s.lineTo(u,t);return s.stroke(),i}},n.Microphone=function(t,e,n,o){navigator.getUserMedia_=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,this._isSupported=!!navigator.getUserMedia_,this._stream=null,this._onConnected=t.bind(o||this),this._onDenied=e?e.bind(o||this):function(){},this._onError=n?n.bind(o||this):function(){}},n.Microphone.prototype.connect=function(){if(this._isSupported){var t=this;return navigator.getUserMedia_({audio:!0},function(e){t._stream=e,t._onConnected(e)},function(e){"PermissionDeniedError"===e.name||"PERMISSION_DENIED"===e?(console.log("Permission denied. You can undo this by clicking the camera icon with the red cross in the address bar"),t._onDenied()):t._onError(e.message||e)}),this}},n.Microphone.prototype.disconnect=function(){return this._stream&&(this._stream.stop(),this._stream=null),this},Object.defineProperty(n.Microphone.prototype,"stream",{get:function(){return this._stream}}),Object.defineProperty(n.Microphone.prototype,"isSupported",{get:function(){return this._isSupported}}),"object"==typeof e&&e.exports&&(e.exports=n)},{}]},{},[1])(1)});