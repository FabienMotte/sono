<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
    <title>Sono - Examples - Fade</title>
    <link href="css/styles.css" rel="stylesheet">
</head>
<body>
    <h1>Fade</h1>

    <button class="Player-button" data-js="button-crossfade">CROSS</button>
    <button class="Player-button" data-js="button-fadein">IN</button>
    <button class="Player-button" data-js="button-fadeout">OUT</button>
    <div class="Player-info" data-js="info"></div>

    <script>
        // Test with no WebAudio
        if(window.location.search.substring(1) === 'nowebaudio') {
            window.AudioContext = window.webkitAudioContext = undefined;
        }
    </script>
    <script src="../dist/sono.js"></script>
    <script>
        (function() {
            'use strict';

            Sono.log();

            var soundA = Sono.createSound({
                url: ['audio/music.ogg', 'audio/music.mp3'],
                loop: true,
                volume: 1
            }).play();

            var soundB = Sono.createSound({
                url: ['audio/hit.ogg', 'audio/hit.mp3'],
                loop: true,
                volume: 0
            }).play();

            var btnCross = document.querySelector('[data-js="button-crossfade"]'),
                btnFadeIn = document.querySelector('[data-js="button-fadein"]'),
                btnFadeOut = document.querySelector('[data-js="button-fadeout"]');

            btnCross.addEventListener('click', function() {
                console.log('cross fade:');
                if(soundA.volume > soundB.volume) {
                    soundA.fade(0, 2);
                    soundB.fade(1, 2);
                }
                else {
                    soundA.fade(1, 2);
                    soundB.fade(0, 2);
                }
            });

            btnFadeIn.addEventListener('click', function() {
                Sono.fade(1, 2);
            });

            btnFadeOut.addEventListener('click', function() {
                Sono.fade(0, 2);
            });

            var info = document.querySelector('[data-js="info"]');

            function update() {
                window.requestAnimationFrame(update);

                info.innerHTML = '<p>Sono.volume: ' + Sono.volume.toFixed(2) +
                    '<br />soundA.volume: ' + soundA.volume.toFixed(2) +
                    '<br />soundB.volume: ' + soundB.volume.toFixed(2) + '</p>';
            }
            update();


        }());
    </script>
</body>
</html>
