<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
    <title>Sono - Examples - Destroy</title>
    <link href="css/styles.css" rel="stylesheet">
</head>
<body>
    <h1>Destroy</h1>

    <div data-js="info"></div>

    <button class="Player-button" data-js="button-destroy">GO</button>

    <script>
        // Test with no WebAudio
        if(window.location.search.substring(1) === 'nowebaudio') {
            window.AudioContext = window.webkitAudioContext = undefined;
        }
    </script>
    <script src="../dist/sono.js"></script>
    <script>
        (function() {
            'use strict';

            Sono.log();

            var info = document.querySelector('[data-js="info"]');
            var btn = document.querySelector('[data-js="button-destroy"]');
            var baseURL = 'http://ianmcgregor.me/prototypes/assets/audio/';
            var config = {
                url: [
                    {
                        id: 'bullet',
                        url: [
                            baseURL + 'bullet.ogg',
                            baseURL + 'bullet.mp3'
                        ]
                    },
                    {
                        id: 'collect',
                        url: [
                            baseURL + 'collect.ogg',
                            baseURL + 'collect.mp3'
                        ]
                    },
                    {
                        id: 'hit',
                        url: [
                            baseURL + 'hit.ogg',
                            baseURL + 'hit.mp3'
                        ]
                    },
                    {
                        id: 'select',
                        url: [
                            baseURL + 'select.ogg',
                            baseURL + 'select.mp3'
                        ]
                    },
                    {
                        id: 'music',
                        url: [
                            baseURL + 'music.ogg',
                            baseURL + 'music.mp3'
                        ]
                    },
                    {
                        id: 'piano',
                        url: [
                            'audio/PIANO_MIC_1.ogg',
                            'audio/PIANO_MIC_1.mp3'
                        ]
                    },
                    {
                        id: 'drums',
                        url: [
                            'audio/DRUMS.ogg',
                            'audio/DRUMS.mp3'
                        ]
                    },
                    {
                        id: 'vox',
                        url: [
                            'audio/VOX.ogg',
                            'audio/VOX.mp3'
                        ]
                    },
                    {
                        id: 'Original',
                        url: [
                            'audio/Original.ogg',
                            'audio/Original.mp3'
                        ]
                    },
                    {
                        id: 'PIANO_MIC_2',
                        url: [
                            'audio/PIANO_MIC_2.ogg',
                            'audio/PIANO_MIC_2.mp3'
                        ]
                    },
                    {
                        id: 'CONGAS',
                        url: [
                            'audio/CONGAS.ogg',
                            'audio/CONGAS.mp3'
                        ]
                    },
                    {
                        id: 'DOUBLE_BASS',
                        url: [
                            'audio/DOUBLE_BASS.ogg',
                            'audio/DOUBLE_BASS.mp3'
                        ]
                    },
                    {
                        id: 'ADT',
                        url: [
                            'audio/ADT.ogg',
                            'audio/ADT.mp3'
                        ]
                    },
                    {
                        id: 'Phasing',
                        url: [
                            'audio/Phasing.ogg',
                            'audio/Phasing.mp3'
                        ]
                    },
                    {
                        id: 'Tape_Delay',
                        url: [
                            'audio/Tape_Delay.ogg',
                            'audio/Tape_Delay.mp3'
                        ]
                    },
                    {
                        id: 'Tape_Saturation',
                        url: [
                            'audio/Tape_Saturation.ogg',
                            'audio/Tape_Saturation.mp3'
                        ]
                    },
                    {
                        id: 'Reverse',
                        url: [
                            'audio/Reverse.ogg',
                            'audio/Reverse.mp3'
                        ]
                    },
                    {
                        id: 'TEST',
                        url: [
                            'audio/TEST.ogg',
                            'audio/TEST.mp3'
                        ]
                    },
                    {
                        id: 'Speed_Up',
                        url: [
                            'audio/Speed_Up.ogg',
                            'audio/Speed_Up.mp3'
                        ]
                    },
                    {
                        id: 'Speed_Down',
                        url: [
                            'audio/Speed_Down.ogg',
                            'audio/Speed_Down.mp3'
                        ]
                    },
                    {
                        id: 'Flanging',
                        url: [
                            'audio/Flanging.ogg',
                            'audio/Flanging.mp3'
                        ]
                    }
                ],
                onComplete: function() {
                    btn.disabled = false;
                    info.insertAdjacentHTML('beforeend', '<p>Sounds loaded: ' + Sono.sounds.length + '</p>');
                },
                asMediaElement: false
            };
            var destroy = function() {
                document.body.removeEventListener('click', destroy);
                info.insertAdjacentHTML('beforeend', '<p>Sono.sounds.length: ' + Sono.sounds.length + '</p>');
                Sono.sounds.forEach(function(sound) {
                    Sono.destroySound(sound);
                });
                info.insertAdjacentHTML('beforeend', '<p>Destroyed!</p>');
                info.insertAdjacentHTML('beforeend', '<p>Sono.sounds.length: ' + Sono.sounds.length + '</p>');
                Sono.sounds.forEach(function(sound) {
                    info.insertAdjacentHTML('beforeend', '<p>Could not destroy: ' + sound.id + '</p>');
                });
            };
            btn.disabled = true;
            btn.addEventListener('click', destroy);
            Sono.load(config);

        }());
    </script>
</body>
</html>
