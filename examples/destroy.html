<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
    <title>Sono - Examples - Destroy</title>
    <link href="css/styles.css" rel="stylesheet">
</head>
<body>
    <h1>Destroy</h1>

    <section>

        <div data-js="info"></div>
        <button class="Player-button" data-js="button-destroy">GO</button>

    </section>

    <script>
        // Test with no WebAudio
        if(window.location.search.slice(1) === 'nowebaudio') {
            window.AudioContext = window.webkitAudioContext = undefined;
        }
    </script>
    <script src="../dist/sono.js"></script>
    <script>
        (function() {
            'use strict';

            Sono.log();

            var info = document.querySelector('[data-js="info"]');
            var btn = document.querySelector('[data-js="button-destroy"]');
            var baseURL = 'https://dl.dropboxusercontent.com/u/15470024/prototypes/audio/';
            var config = {
                url: [
                    {
                        id: 'bullet',
                        url: [
                            baseURL + 'bullet.ogg',
                            baseURL + 'bullet.mp3'
                        ]
                    },
                    {
                        id: 'collect',
                        url: [
                            baseURL + 'collect.ogg',
                            baseURL + 'collect.mp3'
                        ]
                    },
                    {
                        id: 'hit',
                        url: [
                            baseURL + 'hit.ogg',
                            baseURL + 'hit.mp3'
                        ]
                    },
                    {
                        id: 'select',
                        url: [
                            baseURL + 'select.ogg',
                            baseURL + 'select.mp3'
                        ]
                    },
                    {
                        id: 'music',
                        url: [
                            baseURL + 'music.ogg',
                            baseURL + 'music.mp3'
                        ]
                    }
                ],
                onComplete: function() {
                    btn.disabled = false;
                    info.insertAdjacentHTML('beforeend', '<p>Sounds loaded: ' + Sono.sounds.length + '</p>');
                },
                asMediaElement: false
            };
            var destroy = function() {
                document.body.removeEventListener('click', destroy);
                info.insertAdjacentHTML('beforeend', '<p>Sono.sounds.length: ' + Sono.sounds.length + '</p>');
                Sono.sounds.forEach(function(sound) {
                    Sono.destroySound(sound);
                });
                info.insertAdjacentHTML('beforeend', '<p>Destroyed!</p>');
                info.insertAdjacentHTML('beforeend', '<p>Sono.sounds.length: ' + Sono.sounds.length + '</p>');
                Sono.sounds.forEach(function(sound) {
                    info.insertAdjacentHTML('beforeend', '<p>Could not destroy: ' + sound.id + '</p>');
                });
            };
            btn.disabled = true;
            btn.addEventListener('click', destroy);
            Sono.load(config);

        }());
    </script>
</body>
</html>
